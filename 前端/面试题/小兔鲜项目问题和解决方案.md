# 路由相关
## 路由缓存问题
**问题描述**：
*当路由只有参数变化的时候，会复用组件实例*，导致不用调用钩子函数，导致数据没有更新，导致数据和组件都没有刷新。
**解决方案**：
方案一：
给组件加上key，这样组件就不会被复用，从而会调用钩子函数，获取数据。(不在意性能，简单粗暴，所有的组件都重新构建)
**方案二**：
添加路由守卫，`onBeforeRouteUpdate`，当路由发生变化时，使用新路由的信息请求最新的分类数据。（可以精细化控制，只更新需要更新的数据）
![[Pasted image 20230923092740.png]]
## 定制路由行为
**描述**：
在不同路由切换的时候，可以**自动滚动到页面的顶部**，而不是停留在原先的位置。
**解决方案**：
在路由中使用`scrollBehavior`来控制页面切换时浏览器的定位。
![[Pasted image 20230921214010.png]]

# 通用技术
## 列表无限加载
**描述**：
当滚动条滚动到底部时，如果还有数据就请求下一页数据，并继续加载，如果没有数据了就禁用滚动。
**解决方案**：
使用elementplus提供的`v-infinite-scroll`监听滚动条是否触底。
如果还能请求到下一页数据，就把新一页的数据拼接到当前的商品数组里面（解构再收集）。
如果没有下一页数据了就把`infinite-scroll-disabled`设置为true。
```html
      <div class="body" v-infinite-scroll="load" :infinite-scroll-disabled="disabled">
        <!-- 商品列表-->
        <GoodsItem v-for="goods in goodList" :goods="goods" :key="goods.id" />
      </div>
```
## 通用组件统一注册全局
**描述**：
一些组件可能在多个页面被使用，通过插件的方式全局注册
**解决方案**：
第一步：提供插件对象
![[Pasted image 20230921220453.png]]
第二步，全局注册
![[Pasted image 20230921220644.png]]

## anxios封装
**请求拦截封装token**
**响应拦截进行统一错误处理**
![[Pasted image 20230921225309.png]]
**401拦截处理**，token失效时，清除token，并返回登录页面

## 退出登录
- **弹窗确认退出登录（因为退出登录比较危险，所以需要二次确认）
- **清除当前用户登录信息**
- **跳转到登录页面**
![[Pasted image 20230921225724.png]]
## 购物车列表统计数据
![[Pasted image 20230922093237.png]]
**解决方案**
使用计算属性，计算已选商品的数量和总金额
## 删除购物车逻辑
- 调用删除购物车接口
- 调用获取购物车接口
- 用接口购物车列表覆盖本地购物车列表
## Tab切换类需求
**描述**：
存在多个tab页，当点击某个tab页后，这个tab页加上active类样式
![[Pasted image 20230922101609.png]]
**实现**：
点击时记录一个当前激活页对象，点击哪个页就把哪个页记录下来
`v-for`渲染tab页的时候，使用动态样式，如果当前列表项是激活页对象就加上active类样式。`:class="{ active: activeAddress.id === item.id }"`
## 倒计时
- 支付倒计时
- 使用setInterval每隔一秒减一
- 组件销毁时清除定时器
![[Pasted image 20230922112856.png]]
