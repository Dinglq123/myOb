
# 浏览器、服务器、协议
## 输入url到展示页面加载，服务器和浏览器的操作
**浏览器方面**
- DNS解析：浏览器向DNS服务器发送请求，获取该URL对应的IP地址。如果DNS缓存中没有该URL对应的IP地址，则向上级DNS服务器发起请求，直至获取到IP地址。
- TCP连接：浏览器使用获取到的IP地址和端口号，向服务器发起TCP连接。连接建立后，浏览器向服务器发送请求报文。
- 服务器处理请求并响应：服务器接收到浏览器发来的请求报文后，根据其中的URL和其他信息，生成响应报文，并返回给浏览器。
- 浏览器处理响应内容：浏览器收到服务器返回的响应报文后，会开始解析响应内容。如果响应内容是HTML，浏览器会开始解析HTML并构建DOM树；如果响应内容包含CSS、JavaScript等资源，则浏览器会再次向服务器发送请求，获取这些资源并解析它们。
- 页面渲染：浏览器根据解析后的DOM树和CSS规则，开始渲染页面。浏览器将元素布局在页面上，并为每个元素计算样式，最终生成可视化的页面。

**服务器方面**
- 接收请求：服务器接收到浏览器的请求报文，并解析其中的URL和其他信息。
- 处理请求：服务器根据URL以及其他信息，从数据库或文件系统中获取相应的数据，并进行处理。如果需要访问其他服务，则会向其他服务发起请求。
- 生成响应报文：服务器根据处理结果，生成响应报文，并将其返回给浏览器。
- 关闭连接：浏览器接收到响应报文并处理完后，会在Server设置的Max-Age过期时间内保留连接，继续访问该服务；否则断开连接，关闭TCP连接。
以上是从输入URL到展示页面加载的一般流程，不同的网站或应用可能会有不同的细节实现，但总体流程是类似的。
## 三次握手和四次挥手
TCP协议是一种面向连接的可靠传输协议，为了保证通信的可靠性，在建立和断开连接时需要通过三次握手和四次挥手来确保通信双方的状态同步，避免数据丢失或重复等问题。
### 三次握手
TCP 的三次握手是为了保证双方建立起可靠的连接。

在 TCP 连接建立的过程中，需要双方都确认对方的身份以及双方都愿意接受数据传输。如果只有两次握手，则无法防止失效的连接请求报文段进入网络并导致意外的连接中断。

下面是三次握手的流程：

**客户端发送 SYN 报文**
客户端向服务器发送一个 SYN（Synchronize）报文，表示客户端请求建立连接，并发送一个随机序列号 A。

**服务器回复 SYN+ACK 报文**
服务器收到客户端的请求后，会回复一个 SYN+ACK 报文，其中 SYN 域表示同步请求，ACK 域表示已经确认收到了客户端的请求，同时会发送一个随机序列号 B。

**客户端回复 ACK 报文**
客户端收到服务器的 SYN+ACK 报文后，会发送一个 ACK（Acknowledgement）报文，表示确认收到了服务器的响应，并将服务器发来的序列号加一作为 ACK 的序列号，表示双方已经建立了可靠的连接。

通过这个三次握手的过程，可以确保双方可以正常通信。第一次握手客户端发送请求，第二次握手服务端确认请求并发送确认，第三次握手客户端再次确认，这样就建立了一个可靠的连接。因此，TCP 的三次握手是必要的，可以确保数据传输的可靠性和完整性。
### 四次挥手
四次挥手是因为 TCP 的连接是全双工的，也就是说每个方向上的数据传输是独立的。在关闭连接时，需要两个方向上都发送确认信息，才能确认这个方向上的数据传输已经结束。

下面是四次挥手的流程：

**浏览器发送 FIN 报文**
浏览器向服务器发送一个 FIN（Finish）报文，用于关闭数据传输的方向。

**服务器回复 ACK 报文**
服务器收到 FIN 报文后，会回复一个 ACK（Acknowledgement）报文作为响应，表示收到了关闭请求。

**服务器发送 FIN 报文**
当服务器也想要关闭传输方向时，它也会发送 FIN 报文，并等待另一方的 ACK 报文。

**浏览器回复 ACK 报文**
收到服务器的 FIN 报文后，浏览器方回复 ACK 报文以确认收到了关闭请求，这样双方都可以成功关闭连接。

总之，四次挥手是因为 TCP 连接是全双工的，双方都需要发送确认信息来关闭连接，有利于确保数据传输的完整性和可靠性。

## http和https
HTTP（Hypertext Transfer Protocol）是一种基于TCP/IP协议的客户端-服务端请求-响应协议，用于从Web服务器传输超文本到本地浏览器。HTTP是一种无状态协议，通信过程中不会保留任何相关信息，每个请求都是独立的，服务器也不需要为维护用户状态而消耗额外的资源。

HTTPS（Hypertext Transfer Protocol Secure）是在HTTP协议的基础上，通过SSL/TLS加密传输协议。它使用了公钥加密和对称加密两种方式来保证数据传输的安全性。HTTPS协议不仅加密了传输的内容，还能对网站进行认证，确保用户访问的是合法的网站。HTTPS在保障用户信息安全、防止数据被篡改和窃听方面比HTTP更加安全可靠。

下面是HTTP和HTTPS的主要区别：

HTTP使用明文传输数据，传输过程不加密，安全性差；HTTPS采用SSL/TLS对数据进行加密和验证，传输过程更加安全可靠。

HTTP连接是无状态的，服务器不会保存历史状态，无法确认发送请求的客户端身份；HTTPS采用证书来验证网站的真实性，可以为用户提供更可靠的身份确认。

因为HTTP传输的是明文数据，容易受到窃听、篡改等攻击；HTTPS提供了数据加密和完整性校验，能够有效地防止中间人攻击等安全威胁。

综上所述，HTTPS协议相对于HTTP协议来说更加安全可靠，逐渐成为互联网上常用的数据传输协议。
|         特点          |               HTTP                |                  HTTPS                   |
|:--------------------:|:----------------------------------:|:-------------------:|
|          安全性        |            不安全                 |                     安全                 |
|         传输速度      |           快速                   |                   较慢                   |
|         加密方式      |             无加密               | SSL/TLS加密                              |
|      证书认证方式    |              无认证              | 通过数字证书进行认证                    |
|    默认端口号        |              80端口             |               443端口                    |
|       安全标示符     |              无安全标识符        |        有锁形状的安全标识符             |
|        原理           | 请求-响应模式，明文传输数据| 请求-响应模式，采用加密方式传输数据   |
## 怎么解决跨域问题
* JSONP
* PostMessage
* document.domain
* Websocket
* CORS
* Nginx 反向代理
* Node 中间件代理
**跨域**是指在同一个网站的不同页面之间或者不同的网站之间进行数据交互时，由于安全限制而导致请求被浏览器阻止，从而产生的问题。简单来说，如果一个网页的JavaScript代码试图访问另一个域名（或端口、协议）下的资源，就会发生跨域问题。

常见的解决跨域问题的方式有以下几种：

使用JSONP：JSONP利用动态添加`<script>`标签实现跨域，通过回调函数的方式接收服务器返回的数据。JSONP只支持GET请求，且服务器需要支持JSONP格式才可以使用。[4]

设置代理服务器：将客户端请求发送到本地服务器，由本地服务器将请求转发给目标服务器，再将目标服务器响应返回给客户端。这种方式需要借助服务器代理，相对来说比较麻烦。

CORS（跨域资源共享）：CORS是一种W3C标准，定义了在客户端浏览器与服务器之间，如何使用自定义的HTTP头部让浏览器和服务器进行安全的跨域访问。在客户端请求中添加Origin头部表明请求来自哪个源，在服务器端返回时添加Access-Control-Allow-Origin头部表明允许哪些源跨域请求。使用CORS需要服务器做特殊设置，但相对来说比较简单和安全。

postMessage方法：在不同窗口之间发送消息，但需要浏览器版本支持，并且需要得到目标窗口的同意才能使用。

总的来说，解决跨域问题主要有以上几种方式。不同的场景和需求可以选择不同的解决方法。
## http状态码
一般情况下，服务器返回的code是指HTTP状态码，表示请求处理的结果。常见的HTTP状态码包括以下几种：

1xx（信息提示）：表示服务器已经接受到请求，正在处理中。

2xx（成功）：表示请求已经被服务器正确处理，如200表示请求成功；201表示创建资源成功；204表示请求成功但没有响应内容。

3xx（重定向）：表示请求需要进一步的操作以完成请求，如301表示永久重定向；302表示暂时性重定向；304表示缓存资源未过期。

4xx（客户端错误）：表示请求出现了问题，一般是由于客户端发送的请求有误或者权限不足等问题导致的，如400表示请求不合法；401表示未经授权访问；403表示禁止访问；404表示请求的资源不存在。

5xx（服务器错误）：表示服务器端出现了问题，可能是服务器过载、程序错误等等，如500表示服务器内部错误；503表示服务暂时不可用。